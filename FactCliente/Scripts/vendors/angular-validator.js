angular.module("angularValidator",[]);angular.module("angularValidator").directive("angularValidator",["$injector",function(p){return{restrict:"A",link:function(d,l,t,u){function m(a){var b=a&&"invalid-message"in a.attributes?p.get(a.attributes["invalid-message"].value):!1,d=0;for(;d<a.length;d++)d in a&&q(a[d],b)}function q(a,f){if("validate-on"in a.attributes&&"blur"===a.attributes["validate-on"].value)angular.element(a).on("blur",function(){h(a,f);g(a)});var c=d.$watch(function(){var f=a.value+a.required+b.submitted;if("validator"in
a.attributes){var e=d.$eval(a.attributes.validator.value);b[a.name].$setValidity("angularValidator",e)}else e=void 0;var c=(c=b[a.name])&&"$dirty"in c?c.$dirty:void 0,f=f+e+c;e=(e=b[a.name])&&"$valid"in e?e.$valid:void 0;return f+e},function(){b.submitted?(h(a,f),g(a)):"validate-on"in a.attributes&&"dirty"===a.attributes["validate-on"].value?(h(a,f),g(a)):b[a.name]&&b[a.name].$pristine&&(h(a,f),g(a))});n.push(c)}function h(a,f){var c=function(){return"<i class='fa fa-times'></i> Required"},h=function(){return"<i class='fa fa-times'></i> Invalid"};if(a.name in b){var e=b[a.name],g=r(a);g&&g.remove();if(e.$dirty||d[a.form.name]&&d[a.form.name].submitted)e.$error.required?"required-message"in a.attributes?angular.element(a).after(k(a.attributes["required-message"].value)):angular.element(a).after(k(c)):e.$valid||("invalid-message"in a.attributes?angular.element(a).after(k(a.attributes["invalid-message"].value)):f?angular.element(a).after(k(f.message(e,a))):angular.element(a).after(k(h)))}}function k(a){return"<label class='control-label has-error validationMessage'>"+d.$eval(a)+"</label>"}function r(a){a=angular.element(a).parent().children();for(var b=0;b<a.length;b++)if(angular.element(a[b]).hasClass("validationMessage"))return angular.element(a[b]);return!1}function g(a){if(a.name in b){var c=b[a.name];angular.element(a).removeClass("has-error");angular.element(a.parentNode).removeClass("has-error");(c.$dirty||d[a.form.name]&&d[a.form.name].submitted)&&c.$invalid&&(angular.element(a.parentNode).addClass("has-error"),angular.element(a).addClass("has-error"))}}
var c=angular.element(l)[0],n=[],b=d[c.attributes.name.value];b.submitted=!1;d.$watch(function(){return Object.keys(b).length},function(){angular.forEach(n,function(a){a()});m(c)});l.on("submit",function(a){a.preventDefault();d.$apply(function(){b.submitted=!0});b.$valid&&d.$apply(function(){d.$eval(c.attributes["angular-validator-submit"].value)})});b.reset=function(){for(var a=0;a<c.length;a++)c[a].name&&(b[c[a].name].$setViewValue(""),b[c[a].name].$render());b.submitted=!1;b.$setPristine()};m(c)}}}]);